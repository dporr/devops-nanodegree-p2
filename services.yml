Description: >
    Diego Porras. Project 2 services
    This was created following along the course and editing the necesary
    parts for project submission.
Parameters:
  EnvironmentName:
      Description: Single Parameter that we are passing with the env name.
      Type: String
      Default: Project2
  InstanceType:
    Description: Instance type for ec2 resource allocation
    Type: String
    Default: t3.micro
  AmiId:
    Description: AMI id. Default ubuntu 18.04 LTS
    Type: String
    Default: ami-005bdb005fb00e791

Resources:
  LoadBalancer:
  AutoscalingGroup:
  S3ReadOnlyInstanceProfile:
    Type: AWS::IAM::InstanceProfile
    Properties: 
      Roles: S3ReadOnlyAccessRole
  
  WebAppLaunchConfig:
    Type: AWS::AutoScaling::LaunchConfiguration
    Properties:
      UserData:
        Fn::Base64: !Sub |
         #!/bin/bash
        apt-get update -y
        apt-get install apache2 -y
        systemctl start apache2.service
        cd /var/www/html
        echo "Udacity Demo Web Server Up and Running!" > index.html
      ImageId: !Ref AmiId
      IamInstanceProfile: !Ref S3ReadOnlyInstanceProfile
      SecurityGroups: !Ref WebServerSecGroup
      InstanceType: !Ref InstanceType
      BlockDeviceMappings:
      - DeviceName: "/dev/sdk"
        Ebs:
          VolumeSize: '10'
  BastionHost1:
